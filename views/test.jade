extends layout

block content
    .wrap
        input#iptFile(type="file")
        #container(style="width: 500px; height: 500px; border: 1px solid #ddd; position:relative; margin: 50px auto")
            img#img(src="", style="max-width:100%; max-height: 100%; width: 100%")
            span#filter(style="border: 1px solid red; position: absolute; display: block; width: 200px; height:200px; top: 20px; left: 20px; cursor:move")
    script.
        $('#iptFile').on('change', function(){
            var file = this.files[0];
            if(!/image\/.*/.test(file.type)){
                oc.dialog.tips('Only image file is accept');
                return;
            }
            var reader = new FileReader();
            reader.onload = function(e){
                console.log(this.result);
                $('#img').attr('src', this.result);
            }
            reader.readAsDataURL(file);
        })

        var containerPostion = $('#container').position();

        var downPosition = {};
        var move = function(e){
            var currentPosition = e.originalEvent;
            var ele = $(this);
            var position = ele.position();
            ele.css({
                left: position.left + currentPosition.clientX - downPosition.clientX,
                top: position.top + currentPosition.clientY - downPosition.clientY,
            })
            downPosition = currentPosition;
        }
        $('#filter').on('mousedown', function(e){
            if(e.which === 1){
                downPosition = e.originalEvent;
                $('#filter').off('mousemove');
                $('#filter').on('mousemove', move);
            }
            else{
                $('#filter').off('mousemove');
            }
           
        })
        $(document).on('mouseup', function(){
            console.log('mouseup');
            $('#filter').off('mousemove');
        })

